学习笔记

* 为了方便管理，我们把parser单独拆到文件中
* parser接受HTML文本作为参数，返回一颗dom树
* 选择用FSM来实现HTML的分析
* 在HTML的规范中，已规定HTML的状态
* 主要标签：开始标签、结束标签和自封闭标签
* 从标签构建DOM树的基本技巧是使用栈
* 开始标签时创建元素并入栈，遇到结束标签时出栈
* 自封闭标签即为入栈后又出栈
* 任何元素的父元素是它入栈前的栈顶
* 多个文本节点需要合并
* 文本节点与自封闭标签处理类似
* 创建一个元素后，立即计算CSS
* 真实的浏览器中，会出现重新计算css的情况
* 在计算CSS的时候，我们必须且可以知道当前元素的所有父元素
* 计算匹配的时候，是从子元素到父元素的
* 复杂选择器拆成针对单个元素的选择器，跟父元素队列一一匹配
* 在循环父元素队列时，根据选择器类型跟当前元素匹配
* 选择器权重是用四元组实现的（[0，0，0，0]）。越左边权重越高。比较时从左到右比较，一旦左边比较完成，不需要比较后边的数字。
* 四元组第一个元素对应行间样式，第二个对应id选择器，第三那个对应class选择器，第四个对应tag选择器
